---
title: Js 事件循环
outline: deep
author: ht
date: 2022-6
tags: ["javascript"]
---

## 前言

JS 是一门单线程语言，就意味着所有的任务是需要排队的，前一个任务结束，才会执行下一个任务。这样会导致一个问题， 如果前一个任务执行时间过长，后一个任务需要等待，那么整个程序就会阻塞。
为了解决这个问题，JS 出现了同步与异步，他们的本质区别就是：一条线上各个任务执行的顺序不同。

同步任务： 及主线程的任务，按照顺序由上而下执行，当前一个任务执行完毕，再执行后一个任务。

异步任务： 不会进入主线程，而是进入任务队列中，执行完毕后会回调一个函数，并通知主线程，当主线程的任务完成，会去任务队列中查看是否有任务，有的话执行。

## 事件循环

> 事件循环又称消息循环，指 JS 代码在运行环境编译器的一种解析执行规则。

### 宏任务与微任务

1. 微任务与宏任务就属于 js 代码的范畴
2. js 代码主要分为两大类： 同步代码、异步代码
3. 异步代码又分为：微任务与宏任务

![task](/task.awebp)

### 事件循环 Event Loop 执行机制

> 1.进入到 script 标签,就进入到了第一次事件循环.

> 2.遇到同步代码，立即执行

> 3.遇到宏任务,放入到宏任务队列里.

> 4.遇到微任务,放入到微任务队列里.

> 5.执行完所有同步代码

> 6.执行微任务代码

> 7.微任务代码执行完毕，本次队列清空

> 寻找下一个宏任务，重复步骤 1
> 以此反复直到清空所以宏任务，这种不断重复的执行机制，就叫做事件循环。

![Alt text](/event_loop.awebp)
